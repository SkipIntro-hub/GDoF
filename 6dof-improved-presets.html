<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>6DoF Prompt Builder</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    :root {
      --primary: #020617;
      --secondary: #0f172a;
      --accent: #38bdf8;
      --accent2: #22c55e;
      --text: #e5e7eb;
      --text-dim: #9ca3af;
      --border: #1f293b;
      --warning: #f59e0b;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: system-ui, sans-serif;
      background: radial-gradient(circle at top, var(--primary) 0, var(--primary) 100%);
      color: var(--text);
      padding: 20px;
      min-height: 100vh;
    }

    .container { max-width: 1400px; margin: 0 auto; }

    /* Header */
    header {
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border);
    }

    h1 {
      font-size: 28px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 8px;
    }

    .subtitle {
      font-size: 14px;
      color: var(--text-dim);
      line-height: 1.5;
    }

    /* NUEVO: Preset Selector Panel - Destacado */
    .preset-panel {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      backdrop-filter: blur(10px);
      margin-bottom: 24px;
    }

    .preset-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .preset-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-dim);
      font-weight: 600;
    }

    .preset-badge {
      font-size: 10px;
      padding: 4px 10px;
      background: rgba(56, 189, 248, 0.15);
      color: var(--accent);
      border-radius: 12px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
    }

    .preset-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
    }

    .preset-card {
      background: rgba(0, 0, 0, 0.3);
      border: 2px solid var(--border);
      border-radius: 10px;
      padding: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .preset-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .preset-card:hover {
      border-color: var(--accent);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(56, 189, 248, 0.2);
    }

    .preset-card:hover::before {
      opacity: 1;
    }

    .preset-card.active {
      border-color: var(--accent2);
      background: rgba(34, 197, 94, 0.08);
      box-shadow: 0 0 0 1px var(--accent2), 0 8px 20px rgba(34, 197, 94, 0.2);
    }

    .preset-card.active::before {
      background: linear-gradient(90deg, transparent, var(--accent2), transparent);
      opacity: 1;
    }

    .preset-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 8px;
    }

    .preset-icon {
      font-size: 24px;
      line-height: 1;
    }

    .preset-check {
      font-size: 18px;
      color: var(--accent2);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .preset-card.active .preset-check {
      opacity: 1;
    }

    .preset-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
    }

    .preset-desc {
      font-size: 11px;
      color: var(--text-dim);
      line-height: 1.4;
      margin-bottom: 12px;
      min-height: 32px;
    }

    .preset-stats {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .preset-stat {
      font-size: 9px;
      padding: 3px 6px;
      background: rgba(56, 189, 248, 0.1);
      border: 1px solid rgba(56, 189, 248, 0.2);
      border-radius: 4px;
      color: var(--accent);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .preset-card.active .preset-stat {
      background: rgba(34, 197, 94, 0.1);
      border-color: rgba(34, 197, 94, 0.3);
      color: var(--accent2);
    }

    /* Layout */
    .main-layout {
      display: grid;
      grid-template-columns: 340px 340px 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    /* Panel */
    .panel {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      backdrop-filter: blur(10px);
    }

    .section-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-dim);
      margin: 20px 0 12px;
      font-weight: 600;
    }

    .section-title:first-child { margin-top: 0; }

    /* Axis Control */
    .axis-control {
      margin-bottom: 20px;
      padding: 14px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border);
      border-radius: 8px;
      position: relative;
    }

    .axis-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 8px;
    }

    .axis-title-group {
      flex: 1;
    }

    .axis-tag {
      font-size: 9px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-dim);
      margin-bottom: 4px;
    }

    .axis-name {
      font-size: 15px;
      color: var(--text);
      font-weight: 600;
    }

    .axis-value {
      font-size: 14px;
      color: var(--text);
      font-weight: 600;
      background: rgba(56, 189, 248, 0.15);
      padding: 4px 10px;
      border-radius: 4px;
    }

    .axis-poles {
      display: flex;
      justify-content: space-between;
      font-size: 10px;
      color: var(--text-dim);
      margin: 8px 0;
    }

    input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      height: 4px;
      border-radius: 4px;
      background: var(--primary);
      outline: none;
      box-shadow: inset 0 0 0 1px var(--border);
      margin: 8px 0;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
      border: 2px solid var(--primary);
      box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.3);
    }

    .axis-state {
      text-align: center;
      font-size: 12px;
      color: var(--accent2);
      font-weight: 500;
      margin-top: 6px;
      padding: 4px;
      background: rgba(34, 197, 94, 0.1);
      border-radius: 4px;
    }

    .help-icon {
      display: inline-block;
      width: 16px;
      height: 16px;
      background: var(--accent);
      color: var(--primary);
      border-radius: 50%;
      text-align: center;
      line-height: 16px;
      font-size: 11px;
      font-weight: bold;
      cursor: help;
      margin-left: 6px;
      position: relative;
    }

    .help-icon:hover::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 120%;
      left: 50%;
      transform: translateX(-50%);
      background: var(--secondary);
      color: var(--text);
      padding: 8px 12px;
      border-radius: 6px;
      border: 1px solid var(--border);
      font-size: 11px;
      white-space: nowrap;
      z-index: 100;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    }

    /* Instruction */
    .instruction-block { margin-top: 20px; }

    textarea {
      width: 100%;
      min-height: 80px;
      padding: 10px;
      background: var(--primary);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      font-family: inherit;
      font-size: 13px;
      resize: vertical;
    }

    textarea:focus { outline: none; border-color: var(--accent); }

    .hint {
      font-size: 11px;
      color: var(--text-dim);
      margin-top: 6px;
      line-height: 1.4;
    }

    /* Dock Button */
    .dock-button {
      width: 100%;
      margin-top: 16px;
      padding: 14px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: var(--primary);
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      box-shadow: 0 8px 20px rgba(56, 189, 248, 0.3);
    }

    .dock-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 28px rgba(56, 189, 248, 0.4);
    }

    /* Visualization */
    .viz-panel { position: relative; }

    #radarChart {
      max-width: 100%;
      height: auto;
    }

    .coherence-section {
      margin-top: 20px;
      padding: 16px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border);
      border-radius: 8px;
    }

    .coherence-header {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-dim);
      margin-bottom: 12px;
      font-weight: 600;
    }

    .coherence-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .coherence-item {
      text-align: center;
    }

    .coherence-label {
      font-size: 10px;
      color: var(--text-dim);
      margin-bottom: 6px;
    }

    .coherence-value {
      font-size: 18px;
      font-weight: 700;
      padding: 8px;
      border-radius: 6px;
    }

    .coherence-value.high {
      color: var(--accent2);
      background: rgba(34, 197, 94, 0.15);
    }

    .coherence-value.medium {
      color: var(--warning);
      background: rgba(245, 158, 11, 0.15);
    }

    .coherence-value.low {
      color: #ef4444;
      background: rgba(239, 68, 68, 0.15);
    }

    /* Output Panel */
    .output-section {
      grid-column: 1 / -1;
      margin-top: 20px;
    }

    .output-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      border-bottom: 1px solid var(--border);
      padding-bottom: 8px;
    }

    .output-tab {
      padding: 8px 16px;
      background: transparent;
      border: 1px solid transparent;
      border-radius: 6px 6px 0 0;
      color: var(--text-dim);
      cursor: pointer;
      font-size: 12px;
      font-weight: 600;
      transition: all 0.2s;
    }

    .output-tab:hover {
      color: var(--text);
      background: rgba(56, 189, 248, 0.1);
    }

    .output-tab.active {
      color: var(--accent);
      background: rgba(56, 189, 248, 0.15);
      border-color: var(--accent);
    }

    .output-content {
      display: none;
    }

    .output-content.active {
      display: block;
    }

    .output-box {
      position: relative;
      background: var(--primary);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 12px;
      line-height: 1.6;
      color: var(--text);
      white-space: pre-wrap;
      max-height: 500px;
      overflow-y: auto;
    }

    .copy-button {
      position: absolute;
      top: 12px;
      right: 12px;
      padding: 6px 12px;
      background: var(--accent);
      color: var(--primary);
      border: none;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .copy-button:hover {
      background: var(--accent2);
      transform: scale(1.05);
    }

    #prompt-type-indicator {
      display: none;
      padding: 12px 16px;
      border-radius: 8px;
      border: 1px solid;
      font-size: 13px;
      margin-bottom: 12px;
      line-height: 1.5;
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .main-layout {
        grid-template-columns: 1fr;
      }

      .preset-grid {
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>6DoF Prompt Builder</h1>
      <p class="subtitle">
        Configure los 6 grados de libertad para crear prompts estructurados o meta-prompts reutilizables
      </p>
    </header>

    <!-- NUEVO: Panel de Presets Destacado -->
    <div class="preset-panel">
      <div class="preset-header">
        <div class="preset-title">Configuraciones Predefinidas</div>
        <div class="preset-badge">Quick Start</div>
      </div>
      <div class="preset-grid">
        <div class="preset-card active" data-preset="custom">
          <div class="preset-card-header">
            <span class="preset-icon">‚öôÔ∏è</span>
            <span class="preset-check">‚úì</span>
          </div>
          <div class="preset-name">Custom</div>
          <div class="preset-desc">Configuraci√≥n personalizada manual</div>
          <div class="preset-stats">
            <span class="preset-stat">Flexible</span>
          </div>
        </div>

        <div class="preset-card" data-preset="quick_analysis">
          <div class="preset-card-header">
            <span class="preset-icon">‚ö°</span>
            <span class="preset-check">‚úì</span>
          </div>
          <div class="preset-name">Quick Analysis</div>
          <div class="preset-desc">An√°lisis r√°pido y sint√©tico</div>
          <div class="preset-stats">
            <span class="preset-stat">Speed</span>
            <span class="preset-stat">Casual</span>
          </div>
        </div>

        <div class="preset-card" data-preset="deep_research">
          <div class="preset-card-header">
            <span class="preset-icon">üî¨</span>
            <span class="preset-check">‚úì</span>
          </div>
          <div class="preset-name">Deep Research</div>
          <div class="preset-desc">Investigaci√≥n exhaustiva y rigurosa</div>
          <div class="preset-stats">
            <span class="preset-stat">Depth</span>
            <span class="preset-stat">Expert</span>
          </div>
        </div>

        <div class="preset-card" data-preset="creative_brief">
          <div class="preset-card-header">
            <span class="preset-icon">üé®</span>
            <span class="preset-check">‚úì</span>
          </div>
          <div class="preset-name">Creative Brief</div>
          <div class="preset-desc">Contenido creativo y atractivo</div>
          <div class="preset-stats">
            <span class="preset-stat">Creative</span>
            <span class="preset-stat">Flow</span>
          </div>
        </div>

        <div class="preset-card" data-preset="exec_summary">
          <div class="preset-card-header">
            <span class="preset-icon">üìä</span>
            <span class="preset-check">‚úì</span>
          </div>
          <div class="preset-name">Exec Summary</div>
          <div class="preset-desc">Resumen ejecutivo estructurado</div>
          <div class="preset-stats">
            <span class="preset-stat">Concise</span>
            <span class="preset-stat">Format</span>
          </div>
        </div>

        <div class="preset-card" data-preset="technical_doc">
          <div class="preset-card-header">
            <span class="preset-icon">üìù</span>
            <span class="preset-check">‚úì</span>
          </div>
          <div class="preset-name">Technical Doc</div>
          <div class="preset-desc">Documentaci√≥n t√©cnica detallada</div>
          <div class="preset-stats">
            <span class="preset-stat">Precise</span>
            <span class="preset-stat">Formal</span>
          </div>
        </div>
      </div>
    </div>

    <div class="main-layout">
      <!-- Traslaciones Panel -->
      <div class="panel">
        <div class="section-title">Traslaciones (QU√â)</div>

        <!-- T1: Alcance -->
        <div class="axis-control">
          <div class="axis-header">
            <div class="axis-title-group">
              <div class="axis-tag">T1 - AMPLITUD</div>
              <div class="axis-name">Alcance</div>
            </div>
            <div class="axis-value" id="d1-value">3/5</div>
          </div>
          <div class="axis-poles">
            <span>Focal</span>
            <span>Expansivo</span>
          </div>
          <input type="range" id="d1" min="1" max="5" value="3" oninput="updateAxis('d1')">
          <div class="axis-state" id="d1-state">Amplio</div>
        </div>

        <!-- T2: Profundidad -->
        <div class="axis-control">
          <div class="axis-header">
            <div class="axis-title-group">
              <div class="axis-tag">T2 - DETALLE</div>
              <div class="axis-name">Profundidad</div>
            </div>
            <div class="axis-value" id="d2-value">3/5</div>
          </div>
          <div class="axis-poles">
            <span>Superficial</span>
            <span>Exhaustivo</span>
          </div>
          <input type="range" id="d2" min="1" max="5" value="3" oninput="updateAxis('d2')">
          <div class="axis-state" id="d2-state">Balanceado</div>
        </div>

        <!-- T3: Formato -->
        <div class="axis-control">
          <div class="axis-header">
            <div class="axis-title-group">
              <div class="axis-tag">T3 - ESTRUCTURA</div>
              <div class="axis-name">Formato</div>
            </div>
            <div class="axis-value" id="d3-value">3/5</div>
          </div>
          <div class="axis-poles">
            <span>Fluido</span>
            <span>Estructurado</span>
          </div>
          <input type="range" id="d3" min="1" max="5" value="3" oninput="updateAxis('d3')">
          <div class="axis-state" id="d3-state">Organizado</div>
        </div>
      </div>

      <!-- Rotaciones Panel -->
      <div class="panel">
        <div class="section-title">Rotaciones (C√ìMO)</div>

        <!-- R1: Estilo -->
        <div class="axis-control">
          <div class="axis-header">
            <div class="axis-title-group">
              <div class="axis-tag">R1 - TONO</div>
              <div class="axis-name">Estilo</div>
            </div>
            <div class="axis-value" id="d4-value">3/5</div>
          </div>
          <div class="axis-poles">
            <span>Casual</span>
            <span>Formal</span>
          </div>
          <input type="range" id="d4" min="1" max="5" value="3" oninput="updateAxis('d4')">
          <div class="axis-state" id="d4-state">Profesional</div>
        </div>

        <!-- R2: L√≥gica -->
        <div class="axis-control">
          <div class="axis-header">
            <div class="axis-title-group">
              <div class="axis-tag">R2 - RAZONAMIENTO</div>
              <div class="axis-name">L√≥gica</div>
            </div>
            <div class="axis-value" id="d5-value">3/5</div>
          </div>
          <div class="axis-poles">
            <span>Intuitivo</span>
            <span>Anal√≠tico</span>
          </div>
          <input type="range" id="d5" min="1" max="5" value="3" oninput="updateAxis('d5')">
          <div class="axis-state" id="d5-state">Equilibrado</div>
        </div>

        <!-- R3: Rigor -->
        <div class="axis-control">
          <div class="axis-header">
            <div class="axis-title-group">
              <div class="axis-tag">R3 - PRECISI√ìN</div>
              <div class="axis-name">Rigor</div>
            </div>
            <div class="axis-value" id="d6-value">3/5</div>
          </div>
          <div class="axis-poles">
            <span>Flexible</span>
            <span>Exacto</span>
          </div>
          <input type="range" id="d6" min="1" max="5" value="3" oninput="updateAxis('d6')">
          <div class="axis-state" id="d6-state">Preciso</div>
        </div>
      </div>

      <!-- Visualization Panel -->
      <div class="panel viz-panel">
        <div class="section-title">Visualizaci√≥n 6DoF</div>
        <canvas id="radarChart"></canvas>

        <div class="coherence-section">
          <div class="coherence-header">An√°lisis de Configuraci√≥n</div>
          <div class="coherence-grid">
            <div class="coherence-item">
              <div class="coherence-label">Coherencia</div>
              <div class="coherence-value high" id="coherence-score">100%</div>
            </div>
            <div class="coherence-item">
              <div class="coherence-label">Perfil</div>
              <div class="coherence-value high" id="profile-match">Balanced</div>
            </div>
          </div>
        </div>

        <div class="instruction-block">
          <div class="section-title">Instrucci√≥n Espec√≠fica (Opcional)</div>
          <textarea 
            id="instruction" 
            placeholder="Escrib√≠ ac√° tu tarea espec√≠fica (opcional). Si lo dej√°s vac√≠o, se genera un meta-prompt reutilizable que pod√©s aplicar a cualquier contenido despu√©s."
          ></textarea>
          <div class="hint">
            üí° <strong>Con instrucci√≥n:</strong> Prompt ejecutable directo<br>
            üí° <strong>Sin instrucci√≥n:</strong> Meta-prompt para aplicar a archivos/docs despu√©s
          </div>
        </div>

        <button class="dock-button" onclick="generate()">
          üöÄ Generar Configuraci√≥n 6DoF
        </button>
      </div>
    </div>

    <!-- Output Section -->
    <div class="panel output-section">
      <div class="output-tabs">
        <button class="output-tab active" onclick="switchTab('prompt')">üìù Prompt Natural</button>
        <button class="output-tab" onclick="switchTab('json')">{ } JSON Config</button>
      </div>

      <div id="prompt-type-indicator"></div>

      <div id="prompt-output-content" class="output-content active">
        <div class="output-box" id="prompt-output">
          // El prompt se generar√° aqu√≠
        </div>
        <button class="copy-button" onclick="copyPrompt()">üìã Copiar</button>
      </div>

      <div id="json-output-content" class="output-content">
        <div class="output-box" id="json-output">
          // La configuraci√≥n JSON se generar√° aqu√≠
        </div>
        <button class="copy-button" onclick="copyJSON()">üìã Copiar</button>
      </div>
    </div>
  </div>

  <script>
    function switchTab(tab) {
      document.querySelectorAll('.output-tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.output-content').forEach(c => c.classList.remove('active'));
      
      if (tab === 'prompt') {
        document.querySelector('[onclick="switchTab(\'prompt\')"]').classList.add('active');
        document.getElementById('prompt-output-content').classList.add('active');
      } else {
        document.querySelector('[onclick="switchTab(\'json\')"]').classList.add('active');
        document.getElementById('json-output-content').classList.add('active');
      }
    }

    // Presets configuration
    const presets = {
      custom: { d1: 3, d2: 3, d3: 3, d4: 3, d5: 3, d6: 3 },
      quick_analysis: { d1: 2, d2: 2, d3: 3, d4: 2, d5: 3, d6: 2 },
      deep_research: { d1: 5, d2: 5, d3: 4, d4: 4, d5: 5, d6: 5 },
      creative_brief: { d1: 3, d2: 3, d3: 4, d4: 2, d5: 2, d6: 2 },
      exec_summary: { d1: 2, d2: 3, d3: 5, d4: 4, d5: 4, d6: 4 },
      technical_doc: { d1: 4, d2: 5, d3: 5, d4: 5, d5: 5, d6: 5 }
    };

    // Axis configuration
    const config = {
      d1: {
        name: "Alcance",
        states: ["Focal", "Acotado", "Amplio", "Extenso", "Expansivo"]
      },
      d2: {
        name: "Profundidad",
        states: ["Superficial", "Ligero", "Balanceado", "Profundo", "Exhaustivo"]
      },
      d3: {
        name: "Formato",
        states: ["Fluido", "Flexible", "Organizado", "Estructurado", "Formal"]
      },
      d4: {
        name: "Estilo",
        states: ["Casual", "Amigable", "Profesional", "Corporativo", "Formal"]
      },
      d5: {
        name: "L√≥gica",
        states: ["Intuitivo", "Narrativo", "Equilibrado", "Razonado", "Anal√≠tico"]
      },
      d6: {
        name: "Rigor",
        states: ["Flexible", "Adaptable", "Preciso", "Estricto", "Exacto"]
      }
    };

    // Chart
    let radarChart;

    function initChart() {
      const ctx = document.getElementById('radarChart').getContext('2d');
      radarChart = new Chart(ctx, {
        type: 'radar',
        data: {
          labels: [
            'T1: Alcance', 
            'T2: Profundidad', 
            'T3: Formato',
            'R1: Estilo', 
            'R2: L√≥gica', 
            'R3: Rigor'
          ],
          datasets: [
            {
              label: 'Traslaciones',
              data: [3, 3, 3, 0, 0, 0],
              borderColor: 'rgba(56, 189, 248, 1)',
              backgroundColor: 'rgba(56, 189, 248, 0.2)',
              borderWidth: 2,
              pointBackgroundColor: 'rgba(56, 189, 248, 1)',
              pointBorderColor: '#fff',
              pointHoverBackgroundColor: '#fff',
              pointHoverBorderColor: 'rgba(56, 189, 248, 1)'
            },
            {
              label: 'Rotaciones',
              data: [0, 0, 0, 3, 3, 3],
              borderColor: 'rgba(34, 197, 94, 1)',
              backgroundColor: 'rgba(34, 197, 94, 0.2)',
              borderWidth: 2,
              pointBackgroundColor: 'rgba(34, 197, 94, 1)',
              pointBorderColor: '#fff',
              pointHoverBackgroundColor: '#fff',
              pointHoverBorderColor: 'rgba(34, 197, 94, 1)'
            }
          ]
        },
        options: {
          scales: {
            r: {
              min: 0,
              max: 5,
              ticks: { 
                stepSize: 1, 
                color: '#9ca3af',
                backdropColor: 'transparent'
              },
              grid: { color: '#1f293b' },
              pointLabels: { 
                color: '#e5e7eb', 
                font: { size: 11 }
              },
              angleLines: { color: '#1f293b' }
            }
          },
          plugins: {
            legend: { 
              display: true,
              position: 'bottom',
              labels: {
                color: '#e5e7eb',
                font: { size: 11 },
                padding: 12
              }
            }
          },
          maintainAspectRatio: true,
          responsive: true
        }
      });
    }

    function updateChart() {
      const values = ['d1', 'd2', 'd3', 'd4', 'd5', 'd6'].map(id => 
        parseInt(document.getElementById(id).value)
      );
      
      radarChart.data.datasets[0].data = [values[0], values[1], values[2], 0, 0, 0];
      radarChart.data.datasets[1].data = [0, 0, 0, values[3], values[4], values[5]];
      radarChart.update();
    }

    function updateAxis(id) {
      const value = parseInt(document.getElementById(id).value);
      const idx = value - 1;
      
      document.getElementById(`${id}-value`).textContent = `${value}/5`;
      document.getElementById(`${id}-state`).textContent = config[id].states[idx];
      
      updateChart();
      validateCoherence();
      
      // Switch to custom if manually adjusted
      setActivePreset('custom');
    }

    function setActivePreset(presetId) {
      document.querySelectorAll('.preset-card').forEach(card => {
        card.classList.remove('active');
      });
      document.querySelector(`[data-preset="${presetId}"]`).classList.add('active');
    }

    function loadPreset(presetId) {
      const preset = presets[presetId];
      Object.keys(preset).forEach(key => {
        document.getElementById(key).value = preset[key];
        updateAxis(key);
      });
      setActivePreset(presetId);
    }

    function validateCoherence() {
      const values = {
        d1: parseInt(document.getElementById('d1').value),
        d2: parseInt(document.getElementById('d2').value),
        d3: parseInt(document.getElementById('d3').value),
        d4: parseInt(document.getElementById('d4').value),
        d5: parseInt(document.getElementById('d5').value),
        d6: parseInt(document.getElementById('d6').value)
      };

      let score = 100;

      if (values.d1 <= 2 && values.d3 >= 4) score -= 15;
      if (values.d2 <= 2 && values.d3 >= 4) score -= 15;
      if (values.d6 >= 4 && values.d4 <= 2) score -= 10;
      if (values.d5 >= 4 && values.d1 <= 2) score -= 10;

      const scoreEl = document.getElementById('coherence-score');
      scoreEl.textContent = `${Math.max(0, score)}%`;
      scoreEl.className = 'coherence-value ' + (score >= 80 ? 'high' : score >= 60 ? 'medium' : 'low');

      const avg = (values.d1 + values.d2 + values.d3 + values.d4 + values.d5 + values.d6) / 6;
      let profile = 'Balanced';
      if (avg <= 2) profile = 'Explorer';
      else if (avg >= 4) profile = 'Executor';
      else if (values.d4 <= 2) profile = 'Creative';
      else if (values.d4 >= 4) profile = 'Expert';
      
      document.getElementById('profile-match').textContent = profile;
    }

    function generate() {
      const values = {
        d1: parseInt(document.getElementById('d1').value),
        d2: parseInt(document.getElementById('d2').value),
        d3: parseInt(document.getElementById('d3').value),
        d4: parseInt(document.getElementById('d4').value),
        d5: parseInt(document.getElementById('d5').value),
        d6: parseInt(document.getElementById('d6').value)
      };

      const instruction = document.getElementById('instruction').value.trim();
      const hasInstruction = instruction.length > 0;

      const traslaciones = {};
      const rotaciones = {};
      
      ['d1', 'd2', 'd3'].forEach(key => {
        const idx = values[key] - 1;
        traslaciones[key] = {
          dimension: config[key].name,
          nivel: values[key],
          estado: config[key].states[idx]
        };
      });
      
      ['d4', 'd5', 'd6'].forEach(key => {
        const idx = values[key] - 1;
        rotaciones[key] = {
          dimension: config[key].name,
          nivel: values[key],
          estado: config[key].states[idx]
        };
      });

      const jsonPayload = {
        version: "6DoF v4.0",
        tipo: hasInstruction ? "prompt_especifico" : "meta_prompt_reutilizable",
        timestamp: new Date().toISOString(),
        traslaciones: traslaciones,
        rotaciones: rotaciones,
        instruccion_original: hasInstruction ? instruction : null,
        nota_uso: hasInstruction 
          ? "Este prompt tiene una instrucci√≥n espec√≠fica incluida." 
          : "Este meta-prompt se aplica a cualquier contenido que proporciones despu√©s: archivos adjuntos, texto, documentos, etc."
      };

      document.getElementById('json-output').textContent = JSON.stringify(jsonPayload, null, 2);

      const lines = [];
      
      lines.push("Configuraci√≥n 6DoF para aplicar en tu respuesta:");
      lines.push("");
      lines.push("TRASLACIONES (QU√â trabajar):");
      lines.push(`‚Ä¢ Alcance: ${config['d1'].states[values.d1 - 1]}`);
      lines.push(`‚Ä¢ Profundidad: ${config['d2'].states[values.d2 - 1]}`);
      lines.push(`‚Ä¢ Formato: ${config['d3'].states[values.d3 - 1]}`);
      lines.push("");
      lines.push("ROTACIONES (C√ìMO trabajar):");
      lines.push(`‚Ä¢ Estilo: ${config['d4'].states[values.d4 - 1]}`);
      lines.push(`‚Ä¢ L√≥gica: ${config['d5'].states[values.d5 - 1]}`);
      lines.push(`‚Ä¢ Rigor: ${config['d6'].states[values.d6 - 1]}`);
      lines.push("");

      if (hasInstruction) {
        lines.push("TAREA ESPEC√çFICA:");
        lines.push(instruction);
        lines.push("");
        lines.push("Aplic√° la configuraci√≥n 6DoF anterior para resolver esta tarea.");
      } else {
        lines.push("MODO DE APLICACI√ìN:");
        lines.push("Aplic√° esta configuraci√≥n 6DoF a cualquier contenido que yo te proporcione a continuaci√≥n.");
        lines.push("");
        lines.push("Esto puede incluir:");
        lines.push("‚Ä¢ Archivos adjuntos (PDF, im√°genes, Excel, Word, etc.)");
        lines.push("‚Ä¢ Texto o informaci√≥n que escriba despu√©s de este prompt");
        lines.push("‚Ä¢ Documentos que necesite analizar o trabajar");
        lines.push("‚Ä¢ Cualquier input adicional que comparta");
        lines.push("");
        lines.push("Proces√° ese contenido usando estrictamente los par√°metros 6DoF definidos arriba.");
      }

      document.getElementById('prompt-output').textContent = lines.join("\n");

      const indicator = document.getElementById('prompt-type-indicator');
      indicator.style.display = 'block';
      if (hasInstruction) {
        indicator.innerHTML = '‚úÖ <strong>Prompt Espec√≠fico:</strong> Listo para ejecutar directamente con la tarea incluida.';
        indicator.style.background = 'rgba(34, 197, 94, 0.1)';
        indicator.style.borderColor = 'rgba(34, 197, 94, 0.3)';
      } else {
        indicator.innerHTML = 'üîÑ <strong>Meta-Prompt Reutilizable:</strong> Peg√° esto primero, despu√©s agreg√° archivos/texto/documentos.';
        indicator.style.background = 'rgba(56, 189, 248, 0.1)';
        indicator.style.borderColor = 'rgba(56, 189, 248, 0.3)';
      }
    }

    function copyJSON() {
      const content = document.getElementById('json-output').textContent;
      navigator.clipboard.writeText(content);
      alert('‚úÖ JSON copiado');
    }

    function copyPrompt() {
      const content = document.getElementById('prompt-output').textContent;
      navigator.clipboard.writeText(content);
      alert('‚úÖ Prompt copiado');
    }

    // Preset card click handlers
    document.querySelectorAll('.preset-card').forEach(card => {
      card.addEventListener('click', function() {
        const presetId = this.getAttribute('data-preset');
        loadPreset(presetId);
      });
    });

    // Initialize
    window.addEventListener('DOMContentLoaded', () => {
      initChart();
      validateCoherence();
      ['d1', 'd2', 'd3', 'd4', 'd5', 'd6'].forEach(updateAxis);
    });
  </script>
</body>
</html>
